profiles:
  - name: shallow
    targetsToBuild:
      - //profiling:bundle
    files:
      - path: profiling/data/raw_a.txt
        sizeBytes: 2048
      - path: profiling/data/raw_b.txt
        sizeBytes: 4096
    packages:
      - path: profiling
        targets:
          - name: preprocess
            inputs:
              - data/*.txt
            command: mkdir -p dist && cat data/*.txt > dist/preprocessed.txt
            outputs:
              - dist/preprocessed.txt
          - name: bundle
            inputs:
              - dist/preprocessed.txt
            dependencies:
              - :preprocess
            command: mkdir -p dist && cat dist/preprocessed.txt dist/preprocessed.txt > dist/bundle.txt
            outputs:
              - dist/bundle.txt
  - name: deep
    targetsToBuild:
      - //deep/app:package
      - //deep/app:mirror
    files:
      - path: deep/data/alpha_1.txt
        sizeBytes: 2048
      - path: deep/data/alpha_2.txt
        sizeBytes: 2048
      - path: deep/data/beta_1.txt
        sizeBytes: 1024
      - path: deep/data/beta_2.txt
        sizeBytes: 1024
      - path: deep/data/gamma_1.txt
        sizeBytes: 4096
      - path: deep/data/gamma_2.txt
        sizeBytes: 4096
      - path: deep/data/delta_1.txt
        sizeBytes: 1024
      - path: deep/data/delta_2.txt
        sizeBytes: 1024
      - path: deep/data/epsilon_1.txt
        sizeBytes: 2048
      - path: deep/data/epsilon_2.txt
        sizeBytes: 2048
      - path: deep/data/zeta_1.txt
        sizeBytes: 1024
      - path: deep/data/zeta_2.txt
        sizeBytes: 1024
    packages:
      - path: deep/components/alpha
        targets:
          - name: alpha
            inputs:
              - ../data/alpha_*.txt
            command: mkdir -p dist && cat ../data/alpha_*.txt > dist/alpha.txt
            outputs:
              - dist/alpha.txt
      - path: deep/components/beta
        targets:
          - name: beta
            inputs:
              - ../data/beta_*.txt
            command: mkdir -p dist && cat ../data/beta_*.txt > dist/beta.txt
            outputs:
              - dist/beta.txt
      - path: deep/components/gamma
        targets:
          - name: gamma
            inputs:
              - ../data/gamma_*.txt
            command: mkdir -p dist && cat ../data/gamma_*.txt > dist/gamma.txt
            outputs:
              - dist/gamma.txt
      - path: deep/components/delta
        targets:
          - name: delta
            inputs:
              - ../data/delta_*.txt
            command: mkdir -p dist && cat ../data/delta_*.txt > dist/delta.txt
            outputs:
              - dist/delta.txt
      - path: deep/components/epsilon
        targets:
          - name: epsilon
            inputs:
              - ../data/epsilon_*.txt
            command: mkdir -p dist && cat ../data/epsilon_*.txt > dist/epsilon.txt
            outputs:
              - dist/epsilon.txt
      - path: deep/components/zeta
        targets:
          - name: zeta
            inputs:
              - ../data/zeta_*.txt
            command: mkdir -p dist && cat ../data/zeta_*.txt > dist/zeta.txt
            outputs:
              - dist/zeta.txt
      - path: deep/app
        targets:
          - name: aggregate
            inputs:
              - ../components/alpha/dist/alpha.txt
              - ../components/beta/dist/beta.txt
              - ../components/gamma/dist/gamma.txt
              - ../components/delta/dist/delta.txt
              - ../components/epsilon/dist/epsilon.txt
              - ../components/zeta/dist/zeta.txt
            dependencies:
              - ../components/alpha:alpha
              - ../components/beta:beta
              - ../components/gamma:gamma
              - ../components/delta:delta
              - ../components/epsilon:epsilon
              - ../components/zeta:zeta
            command: mkdir -p dist && cat ../components/alpha/dist/alpha.txt ../components/beta/dist/beta.txt ../components/gamma/dist/gamma.txt ../components/delta/dist/delta.txt ../components/epsilon/dist/epsilon.txt ../components/zeta/dist/zeta.txt > dist/aggregate.txt
            outputs:
              - dist/aggregate.txt
          - name: package
            inputs:
              - dist/aggregate.txt
            dependencies:
              - :aggregate
            command: mkdir -p dist && cat dist/aggregate.txt dist/aggregate.txt > dist/package.txt
            outputs:
              - dist/package.txt
          - name: mirror
            inputs:
              - dist/aggregate.txt
            dependencies:
              - :aggregate
            command: mkdir -p dist && cp dist/aggregate.txt dist/aggregate_copy.txt
            outputs:
              - dist/aggregate_copy.txt
